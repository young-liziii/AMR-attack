import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np


# from rfml_project.rfml.data import build_dataset

# 设置全局参数，使用支持中文的字体
plt.rcParams['font.sans-serif'] = ['SimHei']  # 使用黑体
plt.rcParams['axes.unicode_minus'] = False  # 正确显示负号
#_, _, test, le = build_dataset(dataset_name="RML2016.10a", path="D:\RML2016.10a_dict.pkl")#set path to your project directory

confusion_matrix = np.array([
    [1.98006645e-01, 5.33388704e-01, 2.07973422e-01, 1.49501661e-03,
    5.48172757e-02, 8.30564784e-04, 8.30564784e-04, 1.32890365e-03,
    3.32225914e-04, 9.96677741e-04, 0.00000000e+00],
    [9.95016611e-02, 6.70431894e-01, 2.01827243e-01, 1.49501661e-03,
  1.97674419e-02, 9.96677741e-04, 1.49501661e-03, 1.49501661e-03,
  1.49501661e-03, 1.49501661e-03, 0.00000000e+00],
 [6.14617940e-03, 3.82059801e-02, 9.06976744e-01, 1.66112957e-03,
  3.15614618e-02, 1.49501661e-03, 3.32225914e-03, 4.81727575e-03,
  3.65448505e-03, 1.99335548e-03, 1.66112957e-04],
 [5.14950166e-03, 1.61129568e-02, 2.81561462e-01, 6.17109635e-01,
  4.76744186e-02, 1.66112957e-03, 2.32558140e-03, 1.09634551e-02,
  1.01328904e-02, 6.31229236e-03, 9.96677741e-04],
 [3.37209302e-02, 2.95681063e-02, 2.56810631e-01, 5.64784053e-03,
  6.63455150e-01, 1.32890365e-03, 2.32558140e-03, 3.48837209e-03,
  2.32558140e-03, 9.96677741e-04, 3.32225914e-04],
 [3.98671096e-03, 1.04651163e-02, 2.19933555e-01, 4.15282392e-03,
  1.61129568e-02, 6.95847176e-01, 2.64119601e-02, 8.97009967e-03,
  4.31893688e-03, 7.64119601e-03, 2.15946844e-03],
 [4.65116279e-03, 1.16279070e-02, 2.95182724e-01, 3.48837209e-03,
  1.91029900e-02, 3.92026578e-02, 5.97009967e-01, 1.14617940e-02,
  8.97009967e-03, 8.47176080e-03, 8.30564784e-04],
 [3.65448505e-03, 1.71096346e-02, 2.94019934e-01, 1.27906977e-02,
  2.20930233e-02, 3.15614618e-03, 8.30564784e-03, 5.63455150e-01,
  4.30232558e-02, 2.37541528e-02, 8.63787375e-03],
 [6.31229236e-03, 1.46179402e-02, 2.93687708e-01, 1.36212625e-02,
  2.57475083e-02, 4.81727575e-03, 8.63787375e-03, 4.55149502e-02,
  5.49169435e-01, 2.94019934e-02, 8.47176080e-03],
 [3.15614618e-03, 1.07973422e-02, 1.86710963e-01, 1.09634551e-02,
  1.91029900e-02, 6.64451827e-03, 6.97674419e-03, 2.89036545e-02,
  4.50166113e-02, 4.13621262e-01, 2.68106312e-01],
 [2.15946844e-03, 7.97342193e-03, 1.16943522e-01, 1.11295681e-02,
  1.56146179e-02, 7.47508306e-03, 7.97342193e-03, 3.22259136e-02,
  3.27242525e-02, 3.59302326e-01, 4.06478405e-01]]
)

# 绘制混淆矩阵的热图
plt.figure(figsize=(10, 8))  # 设置图像大小
sns.heatmap(confusion_matrix, annot=True, cmap='PuRd', fmt='.2%')  # 使用百分比格式显示数值

# 设置x轴和y轴的标签
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.title('CNN+LSTM 混淆矩阵', fontsize=20)
# 保存图像为 PNG 格式
# plt.savefig('CNN&LSTM_CM_plot.png')

# 显示图像
plt.show()
