import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np

# 设置全局参数，使用支持中文的字体
plt.rcParams['font.sans-serif'] = ['SimHei']  # 使用黑体
plt.rcParams['axes.unicode_minus'] = False  # 正确显示负号

confusion_matrix = np.array([
    [2.89202658e-01,4.50332226e-01,1.90033223e-01,2.82392027e-03,4.76744186e-02,2.15946844e-03,9.63455150e-03,5.64784053e-03,6.64451827e-04,8.30564784e-04,9.96677741e-04],
    [7.17607973e-02,7.12126246e-01,1.81893688e-01,1.49501661e-03,1.32890365e-02,1.66112957e-03,8.63787375e-03,5.98006645e-03,1.16279070e-03,9.96677741e-04,9.96677741e-04],
    [1.74418605e-02,1.26245847e-02,8.89867110e-01,3.65448505e-03,2.10963455e-02,4.65116279e-03,2.40863787e-02,1.82724252e-02,1.99335548e-03,3.32225914e-03,2.99003322e-03],
    [8.63787375e-03,5.64784053e-03,2.62126246e-01,6.41362126e-01,3.22259136e-02,3.65448505e-03,1.12956811e-02,1.97674419e-02,4.65116279e-03,5.14950166e-03,5.48172757e-03],
    [2.75747508e-02,1.26245847e-02,2.21096346e-01,4.15282392e-03,7.13621262e-01,1.82724252e-03,6.14617940e-03,8.47176080e-03,1.49501661e-03,1.16279070e-03,1.82724252e-03],
    [4.48504983e-03,4.65116279e-03,1.88538206e-01,1.99335548e-03,7.14285714e-03,7.23754153e-01,5.13289037e-02,1.11295681e-02,1.32890365e-03,2.15946844e-03,3.48837209e-03],
    [7.30897010e-03,6.31229236e-03,2.51661130e-01,2.49169435e-03,9.13621262e-03,3.67109635e-02,6.63787375e-01,1.24584718e-02,3.65448505e-03,2.99003322e-03,3.48837209e-03],
    [8.30564784e-03,5.81395349e-03,2.68604651e-01,1.31229236e-02,1.76079734e-02,2.82392027e-03,1.64451827e-02,5.86046512e-01,4.30232558e-02,1.42857143e-02,2.39202658e-02],
    [9.63455150e-03,5.64784053e-03,2.76578073e-01,1.27906977e-02,1.66112957e-02,2.82392027e-03,1.67774086e-02,5.61461794e-02,5.46345515e-01,2.57475083e-02,3.08970100e-02],
    [4.31893688e-03,4.15282392e-03,1.73920266e-01,8.13953488e-03,1.09634551e-02,4.48504983e-03,1.46179402e-02,3.03986711e-02,3.50498339e-02,4.18106312e-01,2.95847176e-01],
    [5.14950166e-03,2.65780731e-03,1.05647841e-01,7.47508306e-03,1.12956811e-02,7.30897010e-03,8.13953488e-03,2.77408638e-02,2.50830565e-02,3.02325581e-01,4.97176080e-01]
])

# 绘制混淆矩阵的热图
plt.figure(figsize=(10, 8))  # 设置图像大小
sns.heatmap(confusion_matrix, annot=True, cmap='PuRd', fmt='.2%')  # 使用百分比格式显示数值

# 设置x轴和y轴的标签
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.title('CNN 混淆矩阵', fontsize=20)
# 保存图像为 PNG 格式
# plt.savefig('CNN_CM_plot.png')

# 显示图像
plt.show()
